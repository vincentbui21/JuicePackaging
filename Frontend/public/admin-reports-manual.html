<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Reports User Manual</title>
  <style>
    @media print {
      body {
        margin: 0;
        padding: 20px;
      }
      .no-print {
        display: none;
      }
      section {
        page-break-inside: avoid;
      }
      .image-container {
        page-break-inside: avoid;
      }
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
      line-height: 1.6;
      max-width: 900px;
      margin: 0 auto;
      padding: 40px 20px;
      color: #333;
    }

    h1 {
      font-size: 2.5rem;
      font-weight: bold;
      margin-bottom: 2rem;
      color: #1a1a1a;
      border-bottom: 3px solid #4a90e2;
      padding-bottom: 0.5rem;
    }

    h2 {
      font-size: 1.75rem;
      font-weight: 600;
      margin-top: 2.5rem;
      margin-bottom: 1rem;
      color: #2c3e50;
      border-bottom: 2px solid #e0e0e0;
      padding-bottom: 0.5rem;
    }

    section {
      margin-bottom: 2.5rem;
    }

    .image-container {
      margin: 1.5rem 0;
      padding: 1.5rem;
      background: #f8f9fa;
      border-radius: 8px;
      border: 1px solid #dee2e6;
      text-align: center;
    }

    .image-container img {
      width: 100%;
      max-width: 800px;
      height: auto;
      border-radius: 6px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .caption {
      margin-top: 0.75rem;
      font-size: 0.9rem;
      font-style: italic;
      color: #6c757d;
    }

    code {
      background: #f1f3f5;
      padding: 0.2rem 0.4rem;
      border-radius: 4px;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 0.9em;
      color: #e83e8c;
    }

    ul, ol {
      margin-left: 2rem;
      margin-top: 0.75rem;
      margin-bottom: 0.75rem;
    }

    li {
      margin-bottom: 0.5rem;
      line-height: 1.7;
    }

    .print-button {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 12px 24px;
      background: #4a90e2;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      z-index: 1000;
    }

    .print-button:hover {
      background: #357abd;
    }

    .language-selector {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 1000;
    }

    .language-selector select {
      padding: 8px 16px;
      border-radius: 6px;
      border: 1px solid #dee2e6;
      font-size: 1rem;
      cursor: pointer;
    }

    .content {
      display: none;
    }

    .content.active {
      display: block;
    }
  </style>
</head>
<body>
  <div class="language-selector no-print">
    <select id="languageSelect" onchange="switchLanguage()">
      <option value="en">English</option>
      <option value="fi">Suomi (Finnish)</option>
    </select>
  </div>

  <button class="print-button no-print" onclick="window.print()">üñ®Ô∏è Print / Save PDF</button>

  <!-- English Content -->
  <div id="content-en" class="content active">
    <h1>Admin Reports User Manual</h1>
    
    <section>
      <h2>Access</h2>
      <div class="image-container">
        <img src="/manual-images/sidebar-access.png" alt="Admin Reports entry in sidebar" />
        <p class="caption">Admin Reports menu item in the sidebar</p>
      </div>
      <ul>
        <li>Open the left sidebar and select <code>Admin Reports</code>.</li>
        <li>Access requires admin rights or the permission <code>Can view Admin Reports</code>.</li>
      </ul>
    </section>

    <section>
      <h2>Layout</h2>
      <div class="image-container">
        <img src="/manual-images/page-header.png" alt="Admin Reports page header" />
        <p class="caption">Page header with export and save actions</p>
      </div>
      <div class="image-container">
        <img src="/manual-images/filters-card.png" alt="Filters card" />
        <p class="caption">Date range and city filters</p>
      </div>
      <div class="image-container">
        <img src="/manual-images/historical-card.png" alt="Historical Data card" />
        <p class="caption">Historical data management</p>
      </div>
      <ul>
        <li>Header includes <code>Export CSV</code>, <code>Export PDF</code>, <code>Save View</code>, and the theme toggle.</li>
        <li>Filters card controls date range and city selection.</li>
        <li>Historical Data card manages archived seasons and comparisons.</li>
        <li>Tabs split the report into <code>Overview</code>, <code>Costs</code>, <code>Inventory</code>, and <code>Statements</code>.</li>
      </ul>
    </section>

    <section>
      <h2>Filters</h2>
      <div class="image-container">
        <img src="/manual-images/date-filters.png" alt="Date range presets" />
        <p class="caption">Date range presets and custom date selection</p>
      </div>
      <ol>
        <li>Choose a preset: Today, Week, Month, Quarter, or Custom.</li>
        <li>If you select Custom, set <code>Start date</code> and <code>End date</code>.</li>
        <li>Use the City multi-select to filter specific locations.</li>
        <li>Leave the city filter empty to include all cities.</li>
        <li>Reports refresh automatically when the range or cities change.</li>
      </ol>
    </section>

    <section>
      <h2>Header Actions</h2>
      <div class="image-container">
        <img src="/manual-images/export-buttons.png" alt="Export buttons" />
        <p class="caption">Export and Save View buttons</p>
      </div>
      <ul>
        <li><code>Export CSV</code> downloads a file named <code>admin-report-YYYY-MM-DD-to-YYYY-MM-DD.csv</code>.</li>
        <li>CSV includes per-order rows with date, city, customer name, order ID, pouches, kilos, unit price, revenue, plus a totals row.</li>
        <li><code>Export PDF</code> opens a print dialog with a summary and a detailed orders table. Allow pop-ups in your browser.</li>
        <li><code>Save View</code> stores your date range and city selections locally in this browser.</li>
        <li>Theme toggle switches between light and dark modes.</li>
      </ul>
    </section>

    <section>
      <h2>Historical Mode</h2>
      <div class="image-container">
        <img src="/manual-images/historical-mode.png" alt="Historical mode selector" />
        <p class="caption">Historical mode and season selection</p>
      </div>
      <ol>
        <li>Select <code>Current</code>, <code>Historical</code>, or <code>Compare</code> from Report Mode.</li>
        <li>In <code>Historical</code> mode, choose a season to see an info banner with saved totals.</li>
        <li>The main report tabs continue to use your active date range and city filters.</li>
        <li>In <code>Compare</code> mode, pick two seasons and click <code>Compare</code> to view KPI differences.</li>
        <li>Click <code>Archive Season</code> to save a season based on the current date range.</li>
        <li>In the Archive dialog, enter a season name and start/end dates, then confirm.</li>
      </ol>
    </section>

    <section>
      <h2>Overview Tab</h2>
      <div class="image-container">
        <img src="/manual-images/overview-kpis.png" alt="Overview KPI cards" />
        <p class="caption">Key performance indicator cards</p>
      </div>
      <div class="image-container">
        <img src="/manual-images/overview-charts.png" alt="Overview charts" />
        <p class="caption">Production and performance charts</p>
      </div>
      <ul>
        <li>KPIs show total kilos, pouches produced, revenue, gross profit, net profit, and yield.</li>
        <li>Yield compares actual pouches to expected pouches calculated from kilograms produced.</li>
        <li>Insights show total orders, average order value, top city, and average revenue per kg.</li>
        <li>Charts include Production vs Sales (line), Performance by City (bar), and Yield Variance (line).</li>
        <li>Hover charts to see exact values in tooltips.</li>
      </ul>
    </section>

    <section>
      <h2>Costs Tab</h2>
      <div class="image-container">
        <img src="/manual-images/cost-centers.png" alt="Cost centers list" />
        <p class="caption">Cost centers management</p>
      </div>
      <div class="image-container">
        <img src="/manual-images/cost-entries.png" alt="Cost entries table" />
        <p class="caption">Cost entries tracking</p>
      </div>
      <ul>
        <li>Totals chips display Direct, Overhead, and Total costs for the selected date range.</li>
        <li>Create cost centers first, then add cost entries against those centers.</li>
        <li>Cost centers are categorized as <code>Direct</code> or <code>Overhead</code>.</li>
        <li>Cost entries require a date, cost center, and amount; notes are optional.</li>
        <li>Edit and delete actions are available from the icon buttons in each row.</li>
      </ul>
    </section>

    <section>
      <h2>Inventory Tab</h2>
      <div class="image-container">
        <img src="/manual-images/inventory-summary.png" alt="Inventory summary" />
        <p class="caption">Inventory summary table</p>
      </div>
      <div class="image-container">
        <img src="/manual-images/inventory-items.png" alt="Inventory items" />
        <p class="caption">Inventory items list</p>
      </div>
      <div class="image-container">
        <img src="/manual-images/inventory-transactions.png" alt="Inventory transactions" />
        <p class="caption">Inventory transactions table</p>
      </div>
      <div class="image-container">
        <img src="/manual-images/auto-transactions.png" alt="Auto-generated transactions" />
        <p class="caption">Automatically generated transactions</p>
      </div>
      <ul>
        <li>Summary table shows on-hand quantity, unit, last unit cost, and inventory value.</li>
        <li>Add inventory items with name, SKU, unit, category, and optional cost center.</li>
        <li>Transactions track inventory movement with types <code>Purchase</code>, <code>Usage</code>, or <code>Adjustment</code>.</li>
        <li>Quantity must be non-zero; negative quantities are allowed only for Adjustments.</li>
        <li>Unit cost is optional; dates are required.</li>
        <li>Auto-generated transactions are listed separately for reference.</li>
      </ul>
    </section>

    <section>
      <h2>Statements Tab</h2>
      <div class="image-container">
        <img src="/manual-images/income-statement.png" alt="Income statement" />
        <p class="caption">Income statement card</p>
      </div>
      <div class="image-container">
        <img src="/manual-images/balance-sheet.png" alt="Balance sheet" />
        <p class="caption">Balance sheet card</p>
      </div>
      <ul>
        <li>Income Statement shows revenue, direct costs, gross profit, overhead, and net profit.</li>
        <li>Use <code>Export Statement</code> to print or save the income statement.</li>
        <li>Balance Sheet summarizes assets, liabilities, and equity as of the selected end date.</li>
        <li>Add assets with name, category, value, acquired date, and notes.</li>
        <li>Add liabilities with name, category, value, as-of date, and notes.</li>
        <li>Use <code>Export Statement</code> to print or save the balance sheet.</li>
      </ul>
    </section>

    <section>
      <h2>Tips</h2>
      <ul>
        <li>If you see no data, widen the date range or clear the city filter.</li>
        <li>If exports do not open, allow browser pop-ups for this site.</li>
        <li>Deleting entries requires confirmation and cannot be undone.</li>
        <li>Currency values are shown in EUR.</li>
      </ul>
    </section>
  </div>

  <!-- Finnish Content -->
  <div id="content-fi" class="content">
    <h1>Admin Reports K√§ytt√∂ohje</h1>
    
    <section>
      <h2>P√§√§sy</h2>
      <div class="image-container">
        <img src="/manual-images/sidebar-access.png" alt="Admin Reports sivupalkissa" />
        <p class="caption">Admin Reports -valinta sivupalkissa</p>
      </div>
      <ul>
        <li>Avaa vasen sivupalkki ja valitse <code>Admin Reports</code>.</li>
        <li>P√§√§sy vaatii admin-roolin tai oikeuden <code>Can view Admin Reports</code>.</li>
      </ul>
    </section>

    <section>
      <h2>Rakenne</h2>
      <div class="image-container">
        <img src="/manual-images/page-header.png" alt="Sivun otsikko" />
        <p class="caption">Sivun otsikko ja toimintopainikkeet</p>
      </div>
      <div class="image-container">
        <img src="/manual-images/filters-card.png" alt="Suodattimet" />
        <p class="caption">P√§iv√§m√§√§r√§alue ja kaupunkivalitsin</p>
      </div>
      <div class="image-container">
        <img src="/manual-images/historical-card.png" alt="Historical Data" />
        <p class="caption">Historiallisten tietojen hallinta</p>
      </div>
      <ul>
        <li>Yl√§osassa ovat <code>Export CSV</code>, <code>Export PDF</code>, <code>Save View</code> ja teeman vaihto.</li>
        <li>Suodattimet-kortti ohjaa p√§iv√§m√§√§r√§aluetta ja kaupunkia.</li>
        <li>Historical Data -kortti hallinnoi arkistoituja kausia ja vertailuja.</li>
        <li>V√§lilehdet jakavat n√§kym√§n <code>Overview</code>, <code>Costs</code>, <code>Inventory</code> ja <code>Statements</code> -osiin.</li>
      </ul>
    </section>

    <section>
      <h2>Suodattimet</h2>
      <div class="image-container">
        <img src="/manual-images/date-filters.png" alt="P√§iv√§m√§√§r√§valinnat" />
        <p class="caption">P√§iv√§m√§√§r√§presets ja omat p√§iv√§t</p>
      </div>
      <ol>
        <li>Valitse preset: Today, Week, Month, Quarter tai Custom.</li>
        <li>Jos valitset Custom, aseta <code>Start date</code> ja <code>End date</code>.</li>
        <li>Valitse kaupungit monivalinnasta.</li>
        <li>J√§t√§ kaupunkivalinta tyhj√§ksi, jos haluat kaikki kaupungit.</li>
        <li>Raportit p√§ivittyv√§t automaattisesti, kun suodattimet muuttuvat.</li>
      </ol>
    </section>

    <section>
      <h2>Toiminnot</h2>
      <div class="image-container">
        <img src="/manual-images/export-buttons.png" alt="Vientipainikkeet" />
        <p class="caption">Vienti- ja tallennuspainikkeet</p>
      </div>
      <ul>
        <li><code>Export CSV</code> lataa tiedoston <code>admin-report-YYYY-MM-DD-to-YYYY-MM-DD.csv</code>.</li>
        <li>CSV sis√§lt√§√§ tilausrivit: p√§iv√§, kaupunki, asiakas, tilaus-ID, pussit, kilot, yksikk√∂hinta ja liikevaihto sek√§ yhteens√§-rivin.</li>
        <li><code>Export PDF</code> avaa tulostusn√§kym√§n yhteenvedolla ja tilauslistalla. Salli ponnahdusikkunat selaimessa.</li>
        <li><code>Save View</code> tallentaa p√§iv√§m√§√§r√§t ja kaupungit paikallisesti t√§h√§n selaimeen.</li>
        <li>Teeman vaihto vaihtaa vaalean ja tumman v√§lill√§.</li>
      </ul>
    </section>

    <section>
      <h2>Historia</h2>
      <div class="image-container">
        <img src="/manual-images/historical-mode.png" alt="Historiallinen tila" />
        <p class="caption">Report Mode -valitsin ja kausilistat</p>
      </div>
      <ol>
        <li>Valitse <code>Current</code>, <code>Historical</code> tai <code>Compare</code> Report Mode -valikosta.</li>
        <li><code>Historical</code>-tilassa valitse kausi, jolloin n√§et infobannerin tallennetuista kokonaisarvoista.</li>
        <li>Varsinaiset raporttiv√§lilehdet k√§ytt√§v√§t edelleen nykyisi√§ p√§iv√§m√§√§r√§- ja kaupunkisuodattimia.</li>
        <li><code>Compare</code>-tilassa valitse kaksi kautta ja paina <code>Compare</code>, jolloin n√§et KPI-erot.</li>
        <li>Paina <code>Archive Season</code>, jos haluat tallentaa kauden nykyisell√§ p√§iv√§m√§√§r√§alueella.</li>
        <li>T√§yt√§ kauden nimi sek√§ alku- ja loppup√§iv√§ ja vahvista.</li>
      </ol>
    </section>

    <section>
      <h2>Overview Tab</h2>
      <div class="image-container">
        <img src="/manual-images/overview-kpis.png" alt="KPI-kortit" />
        <p class="caption">Keskeisten tunnuslukujen kortit</p>
      </div>
      <div class="image-container">
        <img src="/manual-images/overview-charts.png" alt="Kaaviot" />
        <p class="caption">Tuotanto- ja suorituskaaviot</p>
      </div>
      <ul>
        <li>KPI:t n√§ytt√§v√§t kokonaiskilot, tuotetut pussit, liikevaihdon, bruttokatteen, nettokatteen ja yieldin.</li>
        <li>Yield vertaa tuotettuja pusseja odotettuihin pusseihin kilogrammojen perusteella.</li>
        <li>Insights n√§ytt√§√§ tilausten m√§√§r√§n, keskiostoksen, parhaan kaupungin ja keskim√§√§r√§isen ‚Ç¨/kg.</li>
        <li>Kaaviot: Production vs Sales (viiva), Performance by City (pylv√§s), Yield Variance (viiva).</li>
        <li>Vie hiiri kaavion p√§√§lle n√§hd√§ksesi tarkat arvot.</li>
      </ul>
    </section>

    <section>
      <h2>Costs Tab</h2>
      <div class="image-container">
        <img src="/manual-images/cost-centers.png" alt="Cost centers" />
        <p class="caption">Cost centers -lista</p>
      </div>
      <div class="image-container">
        <img src="/manual-images/cost-entries.png" alt="Cost entries" />
        <p class="caption">Cost entries -taulukko</p>
      </div>
      <ul>
        <li>Yhteenvetochipit n√§ytt√§v√§t Direct-, Overhead- ja Total-kustannukset valitulta ajalta.</li>
        <li>Luo ensin cost centerit, sen j√§lkeen cost entryt.</li>
        <li>Cost center -kategoriat ovat <code>Direct</code> ja <code>Overhead</code>.</li>
        <li>Cost entry vaatii p√§iv√§m√§√§r√§n, cost centerin ja summan; muistiinpanot ovat vapaaehtoisia.</li>
        <li>Muokkaus ja poisto tehd√§√§n rivin kuvakkeista.</li>
      </ul>
    </section>

    <section>
      <h2>Inventory Tab</h2>
      <div class="image-container">
        <img src="/manual-images/inventory-summary.png" alt="Varaston yhteenveto" />
        <p class="caption">Inventory summary -taulukko</p>
      </div>
      <div class="image-container">
        <img src="/manual-images/inventory-items.png" alt="Varastokohteet" />
        <p class="caption">Inventory items -lista</p>
      </div>
      <div class="image-container">
        <img src="/manual-images/inventory-transactions.png" alt="Varastotapahtumat" />
        <p class="caption">Inventory transactions -taulukko</p>
      </div>
      <div class="image-container">
        <img src="/manual-images/auto-transactions.png" alt="Automaattiset tapahtumat" />
        <p class="caption">Automaattisesti luodut tapahtumat</p>
      </div>
      <ul>
        <li>Yhteenveto n√§ytt√§√§ saldo, yksikk√∂, viimeinen yksikk√∂hinta ja varaston arvo.</li>
        <li>Lis√§√§ inventory itemit nimell√§, SKU:lla, yksik√∂ll√§, kategorialla ja halutulla cost centerill√§.</li>
        <li>Transaktiotyypit ovat <code>Purchase</code>, <code>Usage</code> ja <code>Adjustment</code>.</li>
        <li>M√§√§r√§n tulee olla eri kuin nolla; negatiivinen m√§√§r√§ sallitaan vain Adjustmenteissa.</li>
        <li>Yksikk√∂hinta on vapaaehtoinen; p√§iv√§ on pakollinen.</li>
        <li>Auto-generated transactions n√§kyv√§t erillisess√§ listassa viitetietona.</li>
      </ul>
    </section>

    <section>
      <h2>Statements Tab</h2>
      <div class="image-container">
        <img src="/manual-images/income-statement.png" alt="Tuloslaskelma" />
        <p class="caption">Income Statement -kortti</p>
      </div>
      <div class="image-container">
        <img src="/manual-images/balance-sheet.png" alt="Tase" />
        <p class="caption">Balance Sheet -kortti</p>
      </div>
      <ul>
        <li>Income Statement n√§ytt√§√§ liikevaihdon, suorat kulut, bruttokatteen, yleiskulut ja nettokatteen.</li>
        <li><code>Export Statement</code> tulostaa tai tallentaa income statementin.</li>
        <li>Balance Sheet n√§ytt√§√§ varat, velat ja oman p√§√§oman valitun p√§√§ttymisp√§iv√§n mukaan.</li>
        <li>Lis√§√§ varat nimell√§, kategorialla, arvolla, hankintap√§iv√§ll√§ ja muistiinpanolla.</li>
        <li>Lis√§√§ velat nimell√§, kategorialla, arvolla, as-of -p√§iv√§ll√§ ja muistiinpanolla.</li>
        <li><code>Export Statement</code> tulostaa tai tallentaa balance sheetin.</li>
      </ul>
    </section>

    <section>
      <h2>Vinkit</h2>
      <ul>
        <li>Jos dataa ei n√§y, laajenna p√§iv√§m√§√§r√§aluetta tai tyhjenn√§ kaupunkisuodatin.</li>
        <li>Jos vienti ei aukea, salli ponnahdusikkunat t√§lle sivustolle.</li>
        <li>Poistot vaativat vahvistuksen eik√§ niit√§ voi perua.</li>
        <li>Valuutta on euro (EUR).</li>
      </ul>
    </section>
  </div>

  <script>
    function switchLanguage() {
      const lang = document.getElementById('languageSelect').value;
      document.querySelectorAll('.content').forEach(content => {
        content.classList.remove('active');
      });
      document.getElementById('content-' + lang).classList.add('active');
    }
  </script>
</body>
</html>
